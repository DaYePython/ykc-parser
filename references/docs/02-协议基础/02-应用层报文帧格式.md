# 应用层报文帧格式

## 应用层数据结构

| 起始标志 | 数据长度 | 序列号域 | 加密标志 | 帧类型标志 | 消息体 | 帧校验域 |
|----------|----------|----------|----------|------------|--------|----------|
| 1字节 | 1字节 | 2字节 | 1字节 | 1字节 | N字节 | 2字节 |

## 数据结构说明

### 起始标识符
- 代表一帧数据的开始
- 固定为 `0x68`

### 数据域字节数
- 数据域长度不超过200字节
- 不加密时为原数据长度,加密时为加密后数据长度
- 其值为"序列号域+加密标志+帧类型标志+消息体"字节数之和

### 序列号域
- 即为数据包的发送顺序号
- 从0开始顺序增加
- 如是应答数据包,则与询问数据包序号保持一致
- 当桩与平台网络断开重新建立连接或者溢出后归0

### 加密标志
- 只针对消息体(数据单元)
- `0x00`: 不加密
- `0x01`: 3DES加密

### 帧类型标志
- 定义了上下行数据帧类型

### 帧校验域
- 从序列号域到数据域的CRC校验
- 校验多项式为0x180D
- 低字节在前,高字节在后
- 计算方式见附录
