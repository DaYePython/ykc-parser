# 账户余额更新

## 8.9 远程账户余额更新 (0x42)

### 基本信息

| 项目 | 说明 |
|------|------|
| 帧类型码 | 0x42 |
| 传送间隔 | 按需发送 |
| 数据方向 | 运营平台→充电桩 |

### 功能说明

平台在用户完成充值后会将用户更新的余额下发到充电桩,桩接收到此数据帧需要对当前充电用户的信息进行校验并更新余额信息。

### 样例报文

```
68(起始标志)18(数据长度)0006(序列号域)00(加密标志)42(类型)
32010200000001(桩编码)
01(枪号)
00000000D14B0A54(物理卡号:D14B0A54)
00000000(修改后账户金额:0)
72EA(帧校验域)
```

### 数据定义

| 序号 | 参数名称 | 数据类型 | 长度(Byte) | 备注 |
|------|----------|----------|------------|------|
| 1 | 桩编号 | BCD码 | 7 | |
| 2 | 枪号 | BCD码 | 1 | |
| 3 | 物理卡号 | BIN码 | 8 | 不足8位补零<br>**如果不为零:**需要校验本次充电是否为此卡充电<br>**如果为零:**不校验,直接更新桩当前充电用户余额 |
| 4 | 修改后账户金额 | BIN码 | 4 | 保留两位小数 |

---

## 8.10 余额更新应答 (0x41)

### 基本信息

| 项目 | 说明 |
|------|------|
| 帧类型码 | 0x41 |
| 传送间隔 | 应答回复 |
| 数据方向 | 充电桩→运营平台 |

### 功能说明

充电桩接收到远程账户余额更新指令后,需要对当前充电用户的信息进行校验并更新余额信息,然后回复此应答。

### 样例报文

```
68(起始标志)13(数据长度)0006(序列号域)00(加密标志)41(类型)
32010200000001(桩编码)
00000000D14B0A54(物理卡号:D14B0A54)
01(修改结果)
4AC4(帧校验域)
```

### 数据定义

| 序号 | 参数名称 | 数据类型 | 长度(Byte) | 备注 |
|------|----------|----------|------------|------|
| 1 | 桩编号 | BCD码 | 7 | |
| 2 | 物理卡号 | BIN码 | 8 | 不足8位补零,非必填<br>**有物理卡号时:**桩需要校验当前充电是否这此卡充电<br>**没有物理卡号:**则直接更新当前充电用户余额 |
| 3 | 修改结果 | BIN码 | 1 | 0x00:修改成功<br>0x01:设备编号错误<br>0x02:卡号错误 |
